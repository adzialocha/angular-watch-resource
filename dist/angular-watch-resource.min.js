/*! angular-watch-resource.js 28-03-2014 */

!function(a,b){"use strict";function c(){var a=new Date;return a.getTime()}function d(a){var b,c,d;if(b=0,d=a.length,0===d)return b;for(c=0;d>c;c++)b=(b<<5)-b+a.charCodeAt(c),b&=b;return b.toString()}function e(a){var c,d;return c=[],d="",b.forEach(Object.keys(a),function(d){a.hasOwnProperty(d)&&(b.isArray(a[d])?b.forEach(a[d],function(a){c.push(encodeURIComponent(d)+"[]="+a)}):c.push(encodeURIComponent(d)+"="+encodeURIComponent(a[d])))}),c.length>0&&(d="?"+c.join("&")),d}var f=b.module("angular-watch-resource",[]);f.provider("ResourceConfiguration",[function(){var a={basePath:"",defaultData:{},defaultParams:{},defaultHeaders:{}},c={setBasePath:function(b){b&&"string"==typeof b&&(a.basePath=b)},setDefaultData:function(c){c&&b.isObject(c)&&(a.defaultData=c)},setDefaultParams:function(c){c&&b.isObject(c)&&(a.defaultParams=c)},setDefaultHeaders:function(c){c&&b.isObject(c)&&(a.defaultHeaders=c)},$get:function(){return{basePath:a.basePath,defaultData:a.defaultData,defaultParams:a.defaultParams,defaultHeaders:a.defaultHeaders}}};return c}]),f.factory("Resource",["$cacheFactory","$http","ResourceConfiguration",function(a,f,g){function h(a,b){this.url=a,this.values=b}function i(a,b){this._cacheId=a,this._createdTimestamp=c(),this._updatedTimestamp=this._createdTimestamp,this._type=b?"array":"object",this.data=b?[]:{},this.ready=!1,this.error=null}function j(a,c,j){var l={isArray:!1,withCredentials:!1,responseType:"json",method:"GET",data:g.defaultData,params:g.defaultParams,headers:g.defaultHeaders};j&&"object"==typeof j&&b.forEach(Object.keys(j),function(a){a in l&&typeof l[a]==typeof j[a]&&(l[a]=b.isObject(l[a])?b.extend(l[a],j[a]):j[a])});var m=new h(a,c).build(),n=d(m);if(!k.get(n)){var o=new i(n,l.isArray);k.put(n,o);var p={method:l.method,url:g.basePath+m+e(l.params),data:l.data,headers:l.headers,withCredentials:l.withCredentials,responseType:l.responseType,cache:!1};f(p).success(function(a){o.setReady(a),k.put(n,o)}).error(function(a){o.setError(a)})}return k.get(n)}var k=a("resourceCache");return h.prototype.build=function(){var a,c;return this.values?(a=this,c=this.url.replace(/\\:/g,":"),b.forEach(Object.keys(this.values),function(b){c=c.replace(new RegExp(":"+b,"g"),a.values[b])}),c):this.url},i.prototype={setReady:function(a,b){return this.data=a,this.error=null,this.ready=b||!0,this.ready},setError:function(a){return this.error=a,this.ready=!1,!0},set:function(a,b){return this._updatedTimestamp=c(),this.data[a]=b,!0},get:function(a){return this.data[a]},isEmpty:function(){return"array"===this._type&&this.ready?0===this.data.length:"object"===this._type&&this.ready?0===Object.keys(this.data).length:!1}},j}])}(window,window.angular);
//# sourceMappingURL=angular-watch-resource.min.map